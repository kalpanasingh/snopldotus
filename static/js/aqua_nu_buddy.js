// Generated by CoffeeScript 1.7.1
(function() {
  var duckie, duckie_bob, duckie_height, duckie_left, duckie_patrol, duckie_right, duckie_speed, duckie_width, waterlevel_url;

  waterlevel_url = "/waterlevel/level.json";

  duckie_width = 34;

  duckie_height = 15;

  duckie_left = "0px 0px";

  duckie_right = "-" + (duckie_width / 2) + "px 0px";

  duckie_speed = 10000;

  duckie = $("div.duckie");

  duckie_patrol = function(fill_percentage) {

    /* Move duckie from right to left and back continuously */
    var duckie_go_left, duckie_go_right, left_bound, right_bound, _ref;
    _ref = (function() {
      switch (false) {
        case !(fill_percentage < 7 / 80):
          return [161, 219];
        case !(fill_percentage < 15 / 80):
          return [112, 269];
        case !(fill_percentage < 30 / 80):
          return [88, 293];
        case !(fill_percentage < 46 / 80):
          return [62, 319];
        case !(fill_percentage < 49 / 80):
          return [82, 298];
        case !(fill_percentage < 62 / 80):
          return [88, 293];
        case !(fill_percentage < 70 / 80):
          return [112, 269];
        default:
          return [161, 219];
      }
    })(), left_bound = _ref[0], right_bound = _ref[1];
    duckie_go_right = function() {
      duckie.css("background-position", duckie_right);
      duckie.animate({
        left: "" + right_bound + "px"
      }, {
        duration: duckie_speed,
        queue: false,
        easing: 'linear',
        complete: duckie_go_left
      });
      return true;
    };
    duckie_go_left = function() {
      duckie.css("background-position", duckie_left);
      duckie.animate({
        left: "" + left_bound + "px"
      }, {
        duration: duckie_speed,
        queue: false,
        easing: 'linear',
        complete: duckie_go_right
      });
      return true;
    };
    duckie_go_right();
    return true;
  };

  duckie_bob = function(base_depth) {

    /* Move duckie up and down slightly to simulate waves */
    var bob_down, bob_speed, bob_up;
    bob_speed = duckie_speed / 10;
    bob_down = function() {
      duckie.animate({
        bottom: "" + (base_depth - 4) + "px"
      }, {
        duration: bob_speed,
        queue: false,
        easing: 'linear',
        complete: bob_up
      });
      return true;
    };
    bob_up = function() {
      duckie.animate({
        bottom: "" + base_depth + "px"
      }, {
        duration: bob_speed,
        queue: false,
        easing: 'linear',
        complete: bob_down
      });
      return true;
    };
    bob_down();
    return true;
  };

  $(document).ready(function() {
      $.getJSON(waterlevel_url, function(data) {
          var fill_percentage, water_level;
          fill_percentage = data / 80;
          water_level = Math.round((fill_percentage * 400) + 200);
          $("div.water").css('background-size', "600px " + water_level + "px");
          duckie_patrol(fill_percentage);
          duckie_bob(water_level * 0.68);        
          return window.console.log("duckie v0.73 installed");
      });
    
      $( "#ducky" ).click(function() {
          window.location.replace("https://www.snolab.ca/snoplus/private/DocDB/cgi/ShowDocument?docid=1462");
      });
  });

}).call(this);
